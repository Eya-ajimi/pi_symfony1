{% extends 'backend/base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('assets/css2/css/atms.css') }}">  
   <link rel="stylesheet" href="{{ asset('assets/css2/css/styles.min.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}


  
{% block content %}
 

  <div class="main-content">
    <div class="dashboard-header">
      <h1>Welcome, Admin</h1>
      <p>Here is an overview of your InnoMall system.</p>
    </div>

    <div class="cards">
      <div class="card">
        <i class="fas fa-users"></i>
        <h3>Total Users</h3>
        <p>150</p>
      </div>
      <div class="card">
        <i class="fas fa-store"></i>
        <h3>Active Shops</h3>
        <p>35</p>
      </div>
      <div class="card">
        <i class="fas fa-star"></i>
        <h3>Ratings Submitted</h3>
        <p>320</p>
      </div>
      <div class="card">
        <i class="fas fa-comment-dots"></i>
        <h3>Comments</h3>
        <p>450</p>
      </div>
    </div>
     <div class="atm-section">
  <h2>Manage ATMs</h2>

  

  <table class="atm-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Bank Name</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for atm in atms %}
        {% if editingAtmId is defined and editingAtmId == atm.id %}
          <tr class="edit-row">
            <td>{{ atm.id }}</td>
            <td colspan="2">
              {{ form_start(atmForm, {
                'action': path('edit_atm', {'id': atm.id}),
                'attr': { 'class': 'atm-inline-form' }
              }) }}
              <div style="display: flex; gap: 10px;">
                {{ form_widget(atmForm.bankName, {'attr': {'placeholder': 'Bank Name', 'class': 'form-input'}}) }}
                {{ form_widget(atmForm.status, {'attr': {'class': 'form-select'}}) }}
              </div>
              <div style="margin-top: 10px;">
                <button class="btn btn-add"><i class="fas fa-check"></i> Save</button>
                <a href="{{ path('admin_dashboard') }}" class="btn btn-delete"><i class="fas fa-times"></i> Cancel</a>
              </div>
              {{ form_end(atmForm) }}
            </td>
            <td></td>
          </tr>
        {% else %}
          <tr>
            <td>{{ atm.id }}</td>
            <td>{{ atm.bankName }}</td>
            <td>
              {% if atm.status == 'active' %}
                <span style="color: green;"><i class="fas fa-circle"></i> Active</span>
              {% else %}
                <span style="color: gray;"><i class="fas fa-circle-notch"></i> Inactive</span>
              {% endif %}
            </td>
            <td>
              <a href="{{ path('edit_atm', { 'id': atm.id }) }}" class="btn-edit" title="Edit">
                <i class="fas fa-pen"></i>
              </a>
              <a href="{{ path('delete_atm', { 'id': atm.id }) }}" class="btn-delete" title="Delete"
                 onclick="return confirm('Are you sure you want to delete this ATM?');">
                <i class="fas fa-trash-alt"></i>
              </a>
            </td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>

  {% if editingAtmId is not defined %}
      <h2 style="margin-bottom: 20px;">Add New ATM</h2>

      {{ form_start(atmForm, {
          'attr': {
              'class': 'atm-form-inline',
              'novalidate': 'novalidate',
              'name': 'atm_form'
          }
      }) }}

      <div class="atm-inline-row">
          <div class="form-group input-wrapper small-input">
              {{ form_widget(atmForm.bankName, {
                  'attr': {
                      'class': 'form-input',
                      'placeholder': 'Bank Name'
                  }
              }) }}
              {% for error in atmForm.bankName.vars.errors %}
                  <div class="tooltip-error">{{ error.message }}</div>
              {% endfor %}
          </div>

          <div class="form-group input-wrapper small-input">
              {{ form_widget(atmForm.status, {
                  'attr': {
                      'class': 'form-select'
                  }
              }) }}
              {% for error in atmForm.status.vars.errors %}
                  <div class="tooltip-error">{{ error.message }}</div>
              {% endfor %}
          </div>

          <button type="submit" class="btn-add small-btn">Add</button>
      </div>

      {{ form_end(atmForm) }}
  {% endif %}

</div>

{% endblock %}