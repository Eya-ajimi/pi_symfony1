{% extends "maria_templates/base.html.twig" %}
{% block title %}profile
{% endblock %}

{% block body %}

<header>
	Tableau de bord Commerçant
</header>

<div class="container-profile">
	<div class="welcome-banner">
		Bienvenue dans l'espace COMMERCANT
	</div>

	<div class="card">
		<div class="card-header">
			<h4>Profil commerçant</h4>
			<button type="button" id="toggleEdit" class="btn btn-edit btn-sm">
				<i class="fas fa-edit"></i>
				Modifier
			</button>
		</div>
		<div class="card-body">
			<img src="/images/60111.jpg" alt="Photo du magasin" class="profile-image">

			<form method="post" action="{{ path('profile') }}">
				<div class="form-grid">
					<div class="form-group">
						<label>Nom du commerce</label>
						<input type="text" name="nom" class="form-control" value="{{ user.nom }}" disabled>
					</div>
					<div class="form-group">
						<label>Email</label>
						<input type="email" name="email" class="form-control" value="{{ user.email }}" disabled>
					</div>
					<div class="form-group">
						<label>Catégorie</label>
						<select name="categorie" class="form-control" disabled>
							{% for cat in categories %}
								<option value="{{ cat.nom }}" {% if cat.nom == user.categorie %} selected {% endif %}>
									{{ cat.nom }}
								</option>
							{% endfor %}
						</select>
					</div>
					<div class="form-group" style="grid-column: span 2;">
						<label>Description</label>
						<textarea name="description" class="form-control" rows="3" disabled>{{ user.description }}</textarea>
					</div>
					<div class="form-group" style="grid-column: span 2;">
						<label>Mot de passe</label>
						<input type="password" name="password" class="form-control" value="******" disabled>
					</div>
				</div>
				<div style="margin-top: 1.5rem;">
					<button type="submit" id="saveBtn" class="btn btn-success" style="display: none;">Enregistrer</button>
					<button type="button" id="cancelBtn" class="btn btn-cancel" style="display: none;">Annuler</button>
				</div>
			</form>
		</div>
	</div>
</div>{% endblock %}
{% block javascripts %}
<script>
	window.addEventListener('load', function () {
document.body.classList.add('loaded');
});

document.getElementById('toggleEdit').addEventListener('click', function () {
const formControls = document.querySelectorAll('.form-control');
const saveBtn = document.getElementById('saveBtn');
const cancelBtn = document.getElementById('cancelBtn');
const isDisabled = formControls[0].disabled;

formControls.forEach(function (input) {
input.disabled = ! isDisabled;
if (! input.disabled) {
input.classList.add('editable');
} else {
input.classList.remove('editable');
}
});

if (isDisabled) {
this.style.display = 'none';
saveBtn.style.display = 'inline-block';
cancelBtn.style.display = 'inline-block';
}
});

document.getElementById('cancelBtn').addEventListener('click', function () {
window.location.reload();
});
</script>{% endblock %}
